!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.LazyLoad=t()}(this,function(){"use strict";var e=function(e,t,i){this.el=e,this.binding=t,this.vnode=i,this.imagebox=null,this.$vm=i.context,this.$lazyload=i.context.$lazyload};e.prototype.init=function(){this.imagebox=this.vnode.context.imagebox,this.imagebox.add(this.el,this.binding.value),this.listenProcess()},e.prototype.startListen=function(){var e=this.listenProcess;window.addEventListener("scroll",e.bind(this),!1)},e.prototype.removeListen=function(){var e=this.listenProcess;window.removeEventListener("scroll",e.bind(this),!1)},e.prototype.listenProcess=function(){var e=this;0!=this.imagebox.item.length&&this.imagebox.item.forEach(function(t){if(function(e,t){var i=e.ele;e.src;return i.getBoundingClientRect().top+10<(document.documentElement.clientHeight||document.body.clientHeight)}(t)){var i=new Image;i.src=t.src,e._imageStyle(t),e.imagebox.addPending(t.ele,t.src),i.onload=function(){i.complete&&e.imageOnload(t)},i.onerror=function(){e.imageOnerror(t)}}})},e.prototype.update=function(e,t){this.imagebox.update(e,t),this.listenProcess()},e.prototype.imageOnload=function(e){this._removeImageStyle(e.ele),this.imagebox.addAlready(e.ele,e.src),this._imageSet(e.ele,e.src)},e.prototype.imageOnerror=function(e){this._removeImageStyle(e.ele),this.imagebox.addFailed(e.ele,e.src),this._imageSet(e.ele,this.$lazyload.options.errorUrl)},e.prototype._imageStyle=function(e){e.ele.style.background="url("+this.$lazyload.options.loadUrl+") no-repeat center"},e.prototype._removeImageStyle=function(e){e.style.background=""},e.prototype._imageSet=function(e,t){e.src=t};var t=null,i={inserted:function(i,n,o,r){var d=new e(i,n,o);t=d,d.init(),d.startListen()},update:function(e,i,n,o){i.name;var r=i.value,d=i.oldValue;i.expression;r!==d&&t.update(e,r)},unbind:function(){t.removeListen()}},n=function(){this.eleAll=[],this.item=[],this.itemAlready=[],this.itemPending=[],this.itemFailed=[]};n.prototype.add=function(e,t){-1===this.itemAlready.findIndex(function(t){return t.ele===e})&&this.item.push({ele:e,src:t})},n.prototype.update=function(e,t){var i=this.itemAlready.findIndex(function(t){return t.ele===e});if(-1!=i)return this.itemAlready.splice(i,1),void this.add(e,t);var n=this.itemFailed.findIndex(function(t){return t.ele===e});return-1!=n?(this.itemFailed.splice(n,1),void this.add(e,t)):void 0},n.prototype.addFailed=function(e,t){this._addFailed(e,t),this._removeFromPending(e)},n.prototype.addPending=function(e,t){this._addPending(e,t),this._remove(e)},n.prototype.addAlready=function(e,t){this._addAlready(e,t),this._removeFromPending(e)},n.prototype._addAlready=function(e,t){-1===this.itemAlready.findIndex(function(t){return t.ele===e})&&this.itemAlready.push({ele:e,src:t})},n.prototype._addPending=function(e,t){-1===this.itemPending.findIndex(function(t){return t.ele===e})&&this.itemPending.push({ele:e,src:t})},n.prototype._addFailed=function(e,t){-1===this.itemFailed.findIndex(function(t){return t.ele===e})&&this.itemFailed.push({ele:e,src:t})},n.prototype._remove=function(e){var t=this.item.findIndex(function(t){return t.ele===e});-1!=t&&this.item.splice(t,1)},n.prototype._removeFromPending=function(e){var t=this.itemPending.findIndex(function(t){return t.ele===e});-1!=t&&this.itemPending.splice(t,1)};var o={data:function(){return{imagebox:new n}}},r=function(){this.options={loadUrl:"./loading-spin.svg",errorUrl:"./404.svg"}};r.prototype.register=function(e){Object.assign(this.options,e)};return{install:function(e,t){void 0===t&&(t={});var n=new r;n.register(t),e.prototype.$lazyload=n,e.mixin(o),e.directive("simple-lazy",i)}}});
